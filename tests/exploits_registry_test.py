"""Unit tests for the exploits' registry."""
from typing import Type
from agent import definitions
from agent import exploits_registry


def testAnalyzersRegistry_whenRegisteringClassDirectly_shouldLoadClass(
    exploit_instance: Type[definitions.Exploit],
) -> None:
    """Ensure the exploits_registry registers instances of the exploits."""
    exploits_registry.register(exploit_instance)
    registered_exploits = exploits_registry.ExploitsRegistry.values()

    assert len(registered_exploits) >= 1
